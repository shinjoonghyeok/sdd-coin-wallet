<% include ./../_website_theme/header.ejs %>
<div class="page-wrapper">
	<% include ./../_website_theme/nav.ejs %>
	<!-- Content -->
	<section id="register" class=" pv-45 clearfix mb-5">
		<div class="container">
			<div class="row justify-content-md-center">
				<div class="col-md-8 mx-auto " data-animation-effect="fadeInDownSmall">
					<!-- form card login -->
					<div class="card rounded-0">
						<div class="card-header">
							<h3 class="mb-0"><%= __("account_Title") %> </h3>
						</div>
						<div class="card-body">
							<%- messages('website/message', locals) %>
							
							<% if(errors) { errors.forEach(function(error) { %>
							<div class="alert alert-danger  alert-dismissible fade show" role="alert">
								<%= error.msg %>
								<button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>
							</div>
							<%})} %>
							
							<% if(success) { success.forEach(function(success) { %>
							<div class="alert alert-success  alert-dismissible fade show" role="alert">
								<%= success.msg %>
								<button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>
							</div>
							<%})} %>
							
							<div>
								<label><%= __("account_Email") %>: </label><br><strong><%= account.email%></strong>
							</div>
							<hr>
							<div class="mt-3">
								<label><%= __("account_Phone") %>: </label><br><strong><%= account.phone_number%></strong>
							</div>
							<hr>
							<div  class="mt-3">
								<label><%= __("account_SddAddress") %>: </label><br><strong><%= account.sdd_coin_address%></strong>
							</div>
							<hr>
							<div class="mt-3">
								<label><%= __("account_EtherBal") %> : </label><br><strong><%= ethereumBalance%></strong>
							</div>
							<hr>
							<div class="mt-3">
								<label><%= __("account_TokenBal") %>: </label><br><strong><%= tokenBalance%></strong>
							</div>
							<hr>
							<div class="mt-3">
								<label><%= __("account_RegDate") %>: </label><br><strong><%= account.reg_date%></strong>
							</div>
							<hr>
							<div class="mt-3">
								<div class="row">
									<div class="col-sm-6">
										<button id="chgLoginPasswordBtn" class="btn btn-info btn-block mb-2"><%= __("account_ChgPWBTN") %></button>
									</div>
									<div class="col-sm-6">
										<button id="chgWithdrawPasswordBtn" class="btn btn-info btn-block mb-2"><%= __("account_ChgWDBTN") %></button>
									</div>
								</div>
							</div>
							
							<form class="form m-0" role="form" autocomplete="off" id="chgLoginPassword" novalidate="" method="POST" action="/account" style="display:none;">
								<input type="hidden" name="chg_type" value="login" />
								<hr>
								<div class="mt-3">
									<div class="form-row align-items-center mb-3">
										<div class="col-12 col-lg-2 col-md-2">
											<h5 class="mt-2">Old Login Password</h5>
										</div>
										<div class="col-12 col-lg-8 col-md-7">
											<input type="password" class="form-control mb-2" name="old_password" />
										</div>
										<div class="col-12 col-lg-2 col-md-3">

										</div>
									</div>
								</div>
								<hr>
								<div class="mt-3">
									<div class="form-row align-items-center mb-3">
										<div class="col-12 col-lg-2 col-md-2">
											<h5 class="mt-2">New Password</h5>
										</div>
										<div class="col-12 col-lg-8 col-md-7">
											<input type="password" class="form-control mb-2" name="new_password" />
										</div>
										<div class="col-12 col-lg-2 col-md-3">

										</div>
									</div>
								</div>
								<hr>
								<div class="mt-3">
									<div class="form-row align-items-center mb-3">
										<div class="col-12 col-lg-2 col-md-2">
											<h5 class="mt-2">New Password Check</h5>
										</div>
										<div class="col-12 col-lg-8 col-md-7">
											<input type="password" class="form-control mb-2" name="new_password_check" />
										</div>
										<div class="col-12 col-lg-2 col-md-3">

										</div>
									</div>
								</div>
								<div class="mt-3">
									<button id="chgPasswordConfirm" class="btn btn-success btn-block mb-2">Submit</button>
								</div>
							</form>
							
							
							<form class="form m-0" role="form" autocomplete="off" id="chgWithdrawPassword" novalidate="" method="POST" action="/account" style="display:none;">
								<% if(is_wallet) { %>
								<input type="hidden" name="chg_type" value="withdraw" />
								<hr>
								<div class="mt-3">
									<div class="form-row align-items-center mb-3">
										<div class="col-12 col-lg-2 col-md-2">
											<h5 class="mt-2">Old Withdraw Password</h5>
										</div>
										<div class="col-12 col-lg-8 col-md-7">
											<input type="password" class="form-control mb-2" name="old_password" />
										</div>
										<div class="col-12 col-lg-2 col-md-3">

										</div>
									</div>
								</div>
								<hr>
								<div class="mt-3">
									<div class="form-row align-items-center mb-3">
										<div class="col-12 col-lg-2 col-md-2">
											<h5 class="mt-2">New Password</h5>
										</div>
										<div class="col-12 col-lg-8 col-md-7">
											<input type="password" class="form-control mb-2" name="new_password" />
										</div>
										<div class="col-12 col-lg-2 col-md-3">

										</div>
									</div>
								</div>
								<hr>
								<div class="mt-3">
									<div class="form-row align-items-center mb-3">
										<div class="col-12 col-lg-2 col-md-2">
											<h5 class="mt-2">New Password Check</h5>
										</div>
										<div class="col-12 col-lg-8 col-md-7">
											<input type="password" class="form-control mb-2" name="new_password_check" />
										</div>
										<div class="col-12 col-lg-2 col-md-3">

										</div>
									</div>
								</div>
								<div class="mt-3">
									<button id="chgPasswordConfirm" class="btn btn-success btn-block mb-2">Submit</button>
								</div>
								<% } else { %>
								<hr>
								<div class="mt-3">
									<div class="form-row align-items-center mb-3">
										<div class="col-12 col-lg-10 col-md-2">
											<h5 class="mt-2">Make Wallet Password First.</h5>
										</div>
										<div class="col-12 col-lg-2 col-md-3">

										</div>
									</div>
								</div>
								<% } %>
							</form>
							
							
							
						</div>
						<!--/card-block-->
					</div>
					<!-- /form card login -->
				</div>
			</div>
		</div>
	</section>
	<!-- section end -->
</div>

<% include ./../_website_theme/footer.ejs %>

<script>
	$( "#chgLoginPasswordBtn" ).click(function() {
		$( "#chgLoginPassword" ).toggle( "fast", function() {});

		$(this).text(function(i, text){
			return text === "<%= __("account_ChgPWBTN") %>" ? "<%= __("common_Cancel") %>" : "<%= __("account_ChgPWBTN") %>";
		})

	});

	$( "#chgWithdrawPasswordBtn" ).click(function() {
		$( "#chgWithdrawPassword" ).toggle( "fast", function() {});

		$(this).text(function(i, text){
			return text === "<%= __("account_ChgWDBTN") %>" ? "<%= __("common_Cancel") %>" : "<%= __("account_ChgWDBTN") %>";
		})

	});
</script>














<script>
	function validateEmail(sEmail) {
		var filter =/^([\w-\.]+)@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.)|(([\w-]+\.)+))([a-zA-Z]{2,4}|[0-9]{1,3})(\]?)$/;
		if (filter.test(sEmail)) {
			return true;
		} else {
			return false;
		}
	}

	function checkEmail() {
		removeAlert();
		var register = $("#formRegister");
		var email = $('#formRegister input[name=email]');


		if (email.val() == "") {
			$(".card-body").prepend(
				'<div class="alert alert-danger  alert-dismissible " role="alert">Please type your email address<button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button></div>'
			);
			email.focus();
			return;
		}
		var emailVal = email.val()
		if (!validateEmail(emailVal)) {
			$(".card-body").prepend(
				'<div class="alert alert-danger  alert-dismissible " role="alert">Email is Invalid<button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button></div>'
			);
			email.focus();
			return;
		}

		$.ajax({
			cache: false,
			type: "GET",
			url: "/auth/check-email?email=" + email.val(),
			dataType: "JSON",
			success: function (data) {
				if (data) {
					if (data.status === 'error') {
						email.val('');
						$(".card-body").prepend(
							'<div class="alert alert-danger id="" alert-dismissible" role="alert">Email Address is already registered.<button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button></div>'
						);
					} else {
						$(".card-body").prepend(
							'<div class="alert alert-success  alert-dismissible" role="alert">Email Address is available<button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button></div>'
						);
					}
				}
			}
		});
	}

	function checkPhone() {
		removeAlert();
		var register = $("#formRegister");
		var phone = $('#formRegister input[name=phone_number]');

		if (phone.val() == "") {
			$(".card-body").prepend(
				'<div class="alert alert-danger  alert-dismissible " role="alert">Please type your phone number<button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button></div>'
			);
			phone.focus();
			return;
		}

		$.ajax({
			cache: false,
			type: "GET",
			url: "/auth/check-phone?phone=" + phone.val(),
			dataType: "JSON",
			success: function (data) {
				if (data) {
					if (data.status === 'error') {
						phone.val('');
						$(".card-body").prepend(
							'<div class="alert alert-danger  alert-dismissible " role="alert">Phone Number is already registered.<button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button></div>'
						);
					} else {
						$(".card-body").prepend(
							'<div class="alert alert-success  alert-dismissible " role="alert">Phone Number is available<button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button></div>'
						);
					}
				}
			}
		});
	}
</script>